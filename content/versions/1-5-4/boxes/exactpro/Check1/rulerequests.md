---
title: Rule requests
inner-title: check1 - Introduction to verification by rule request
weight : 5
related:
- name: "th2-net/th2-check1"
  icon: "mdi-github"
  href: "https://github.com/th2-net/th2-check1"
---

## The need for verification
When an order message is placed and sent to the exchange (system), the exchange responds with the messages of its own.  These system messages (execution reports) contain information about the placed order, the current status of the order, the price and quantity of the shares and various other required details about the orderâ€™s execution.

The goal of th2 is to check whether the system is performing order execution as expected. One way to verify that the system is properly functioning is to verify the messages sent by the system for accuracy.

This process of meeting expectations is known as verification and is conducted by the th2 component **check1**.

Once verification is complete you are warned about all identified issues.

## The script
The th2-script is code written by the user and contains a set of test scenarios and requests to be sent to the th2 components. In regards to **check1**, the **script** contains the rule requests that you will submit to the **check1** component via gRPC to begin the verification process.

<notice info>
The **check1** can be considered the server side while the **script** is the client side, and communication happens by gRPC technology.
</notice>

**check1** requires expected values for verification, and these are provided by the **script** or the model.

### Information that is verified.

Verification is the comparison of the expected values to the actual results.

The expected values are the following:

- The number of messages a system sends in response to an order message.

- The order in which the system is supposed to send out its messages.

- The parameter values (field values) in each system message (execution report).
<notice info>
The expected values are determined by the user.
</notice>

## Rules

**check1** contains rules, which are a set of logical steps used to conduct the comparison between the expected and the actual results. These rules are unique to **check1** and are found only in the **check1**.

The rules present in check1 are:

- `CheckSequenceRule`

- `CheckRule`

- `NoMessageRule`

Rules are called through a rule request.

<notice info>

The `CheckSequenceRule` is supplemented by `SilenceCheck`.

</notice>

## Rule requests

You are able to initiate the verification process by submitting rule requests to check1. Once these rules requests are received, Check1 begins verification by executing the respective rule. For example, CheckSequenceRuleRequest calls CheckSequenceRule .

These are the three rule requests:

`CheckSequenceRuleRequest` (recommended)

- To be used in cases where you expect more one message will be sent by the system.

- Has added capabilities such as pre-filtering, order checking, and silence check.

`CheckRuleRequest`

- Used to verify a single message, and you are unable to identify additional messages that could be sent by the system.

`NoMessageCheckRequest`

- can pre-filter messages and used to check for unexpected messages.

### Structure of the three rule requests


![](/img/boxes/exactpro/check1/structure_of_each_request.png "Figure 5. structure of each request` ")
<center> 
<figcaption class="mb-2">
Figure 1. Class structure of each request.
</figcaption>
</center>



### Parameters in a rule requests

The following tables provides a list of parameters found in rule requests.

Table 1. The parameters found in all three rule requests

|Name|Type/Class|Actions Performed / Description|
|---|---|---|
|`parent_event_id`|`EventID`|All events generated by the rule will be attached to that parent event.|
|`connectivity_id`|`ConnectionID`|`session_alias` inside the `connectivity_id` must not be empty.|
|`direction`|`Direction`|The direction of the messages to be checked by the rule. *Default*: `FIRST`|
|`chain_id`|`ChainID`|The id used to connect rules together for chain verification. Considers `connectivity_id`.| 
|`description`|`string`|The description that will be added to the root event produced by the rule.|
|`timeout`|`int64`|The allowed timeout for rule execution (message matching). The allocated time is measured in real time. If not set, the default value from check1 settings will be taken (`rule-execution`-timeout in `Check1.yml`, default: `5000 ms`).|
|`message_timeout`|`int64`|Defines the allowed timeout for messages matching by the time they were received. Timeout is computed using the message timestamp.|
|`checkpoint`|`Checkpoint`|Must be set if `message_timeout` is used and no valid `chain_id` is provided.|




Table 2. The parameters unique to `CheckSequenceRuleRequest`

|Name|Type/Class| Actions performed / Description                                                                                    |
|---|---|--------------------------------------------------------------------------------------------------------------------|
|`root_message_filters`|`RootMessageFilter[]`| An ordered list used to identify messages, to verify `metadata.properties` of the message, and check message order.|
|`pre_filter`|`PreFilter`| Pre-filtering for the messages that should not be received. Only messages that match the `pre_filter` parameters will be checked by the main filters. |
|`check_order`|`bool`| If `True`, check1 will validate that messages are received in the defined order.(For example, Execution Report with `OrdStatus`:`Pending` and Execution Report with `OrdStatus`: `New` are received in exactly the same order). |
|`silence_check`|`google.protobuf.BoolValue`| If `True`, check1 will verify incoming messages, which match the pre-filter, after a CheckSequenceRuleRequest has found all the expected messages. Default: `False`. This feature helps to not miss the bugs, where unexpected messages will be received. |



Table 3. The parameters unique to `CheckRuleRequest`
|Name|Type/Class|Actions performed / Description|
|---|---|---|
|`root_filter`|`RootMessageFilter`|Used to verify `metadata.properties` from the message.|


Table 4. The parameters unique to NoMessageCheckRequest

|Name|Type/Class| Actions performed / Description                                   |
|---|---|---|
|`pre_filter`|`PreFilter`| Pre-filtering for the messages that should not be received. Only messages that match the `pre_filter` parameters will be checked by the main filters.| 

