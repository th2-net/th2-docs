<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>th2-common | th2 docs</title><meta name="gridsome:hash" content="073b22652d80460bd37ae7e4ad68d8e665cb0934"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="viewport" content="width=device-width, initial-scale=1"><meta data-vue-tag="ssr" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" hid="description" name="description" content="Documentation for th2 - the next-generation test automation framework for financial markets"><meta data-vue-tag="ssr" hid="keywords" name="keywords" content="Exactpro, th2, test automation, financial technologies, microservices, kubernetes, k8s"><meta data-vue-tag="ssr" hid="og:site_name" name="og:site_name" content="th2 documentation"><meta data-vue-tag="ssr" hid="og:type" name="og:type" content="website"><meta data-vue-tag="ssr" hid="og:title" name="og:title" content="th2 docs"><meta data-vue-tag="ssr" hid="og:description" name="og:description" content="Documentation for th2 - the next-generation test automation framework for financial markets"><meta data-vue-tag="ssr" hid="og:image" name="og:image" content="https://th2.dev/og-image.png"><meta data-vue-tag="ssr" hid="robot" name="robot" content="none"><meta data-vue-tag="ssr" hid="og:title" name="og:title" content="th2-common"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.e540bc2f3d52bc007f88118187e3f363.png"><link data-vue-tag="ssr" rel="stylesheet" href="/css/materialdesignicons.min.css"><link data-vue-tag="ssr" rel="stylesheet" href="/css/roboto.css"><link data-vue-tag="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-vue-tag="ssr" rel="stylesheet" href="/css/lightTheme.css"><link rel="preload" href="/assets/css/0.styles.2da53807.css" as="style"><link rel="preload" href="/assets/js/app.b145ed99.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--documentation-vue.8ae7a293.js" as="script"><link rel="preload" href="/assets/js/vue-remark--content--docs--fundamentals--th-2-common--index-md.5bd95f70.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.8deceafd.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.4258de6a.js"><link rel="prefetch" href="/assets/js/page--src--pages--fundamentals--th2-net-on-github--dashboard-vue.7aef3dfe.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.8fa8a87d.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--fundamentals--th2-net-on-github--dashboard-vue.57cbbdd3.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--documentation-vue.1aeccafd.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--check-1-md.cd6c57d0.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--check-2-recon-md.158751a3.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--codec-md.c6d77297.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--conn-md.b9547de3.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--readme-estore-md.d8e9c6cc.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--readme-infra-operator-md.80fd19e3.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--readme-inframgr-md.311c0241.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--readme-mstore-md.375396d2.js"><link rel="prefetch" href="/assets/js/vue-remark--content--cache--readmes--readme--th-2-infra-md.19bff90a.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--cookbook--chain-verification--index-md.52eea75f.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--cookbook--index-md.d5f16733.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--cookbook--quick-setup-md.fef060cb.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--cookbook--run-box-outside-cluster--index-md.bfa3ec17.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--core--index-md.a4a95357.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--core--th-2-estore-md.e59947c3.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--core--th-2-mstore-md.2e1380cf.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--fundamentals--architecture-md.a36ef5b3.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--fundamentals--index-md.0c3fe5f2.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--fundamentals--key-concepts-md.4a073090.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--fundamentals--script--index-md.a4d59f80.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--fundamentals--th-2-net-on-github-md.91bc70b1.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--create-th-2-env-md.cabd6633.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--index-md.2b01b00d.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--install-th-2--1-base-system-md.bb57e543.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--install-th-2--2-infra-schema-md.44ef8bc9.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--install-th-2--3-th-2-md.38e7814f.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--install-th-2--index-md.c54bcf05.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--requirements--hardware-md.eeff106f.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--requirements--index-md.3ccfb3fe.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--requirements--os-and-network-md.9c0ec77a.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--getting-started--requirements--software-md.4ab01c04.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--index-md.e525a194.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--infra-components--index-md.3fdff2a8.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--infra-components--th-2-infra-mgr-md.d0ff8340.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--infra-components--th-2-infra-operator-md.600c8e05.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--th-2-infra-repository-md.bfadaaf7.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--th-2-infra-schema--links-md.a2190e7a.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--th-2-infra-schema--pins-md.029ddffb.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--infrastructure--th-2-infra-schema-md.cb005e95.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--checkpoints-md.ac7da989.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--communication-md.edb1ae6e.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--configuration-md.a3e45096.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--index-md.3c850c24.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--rulerequests-md.799ba267.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-1--verification-rulerequests-md.7cefb710.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--check-2-recon--index-md.a07a68a8.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--codec--index-md.1549da9f.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--conn--index-md.91d72bde.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--modules--index-md.2ae057c0.js"><link rel="prefetch" href="/assets/js/vue-remark--content--docs--readme--index-md.225b5268.js"><link rel="stylesheet" href="/assets/css/0.styles.2da53807.css"><style data-vue-tag="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">.v-application a { color: #3f979f; }
.v-application .primary {
  background-color: #3f979f !important;
  border-color: #3f979f !important;
}
.v-application .primary--text {
  color: #3f979f !important;
  caret-color: #3f979f !important;
}
.v-application .primary.lighten-5 {
  background-color: #cfffff !important;
  border-color: #cfffff !important;
}
.v-application .primary--text.text--lighten-5 {
  color: #cfffff !important;
  caret-color: #cfffff !important;
}
.v-application .primary.lighten-4 {
  background-color: #b2ffff !important;
  border-color: #b2ffff !important;
}
.v-application .primary--text.text--lighten-4 {
  color: #b2ffff !important;
  caret-color: #b2ffff !important;
}
.v-application .primary.lighten-3 {
  background-color: #95eaf2 !important;
  border-color: #95eaf2 !important;
}
.v-application .primary--text.text--lighten-3 {
  color: #95eaf2 !important;
  caret-color: #95eaf2 !important;
}
.v-application .primary.lighten-2 {
  background-color: #79ced6 !important;
  border-color: #79ced6 !important;
}
.v-application .primary--text.text--lighten-2 {
  color: #79ced6 !important;
  caret-color: #79ced6 !important;
}
.v-application .primary.lighten-1 {
  background-color: #5cb2ba !important;
  border-color: #5cb2ba !important;
}
.v-application .primary--text.text--lighten-1 {
  color: #5cb2ba !important;
  caret-color: #5cb2ba !important;
}
.v-application .primary.darken-1 {
  background-color: #1d7d85 !important;
  border-color: #1d7d85 !important;
}
.v-application .primary--text.text--darken-1 {
  color: #1d7d85 !important;
  caret-color: #1d7d85 !important;
}
.v-application .primary.darken-2 {
  background-color: #00646c !important;
  border-color: #00646c !important;
}
.v-application .primary--text.text--darken-2 {
  color: #00646c !important;
  caret-color: #00646c !important;
}
.v-application .primary.darken-3 {
  background-color: #004c53 !important;
  border-color: #004c53 !important;
}
.v-application .primary--text.text--darken-3 {
  color: #004c53 !important;
  caret-color: #004c53 !important;
}
.v-application .primary.darken-4 {
  background-color: #00343c !important;
  border-color: #00343c !important;
}
.v-application .primary--text.text--darken-4 {
  color: #00343c !important;
  caret-color: #00343c !important;
}
.v-application .secondary {
  background-color: #1e2736 !important;
  border-color: #1e2736 !important;
}
.v-application .secondary--text {
  color: #1e2736 !important;
  caret-color: #1e2736 !important;
}
.v-application .secondary.lighten-5 {
  background-color: #969fb2 !important;
  border-color: #969fb2 !important;
}
.v-application .secondary--text.text--lighten-5 {
  color: #969fb2 !important;
  caret-color: #969fb2 !important;
}
.v-application .secondary.lighten-4 {
  background-color: #7c8598 !important;
  border-color: #7c8598 !important;
}
.v-application .secondary--text.text--lighten-4 {
  color: #7c8598 !important;
  caret-color: #7c8598 !important;
}
.v-application .secondary.lighten-3 {
  background-color: #636c7e !important;
  border-color: #636c7e !important;
}
.v-application .secondary--text.text--lighten-3 {
  color: #636c7e !important;
  caret-color: #636c7e !important;
}
.v-application .secondary.lighten-2 {
  background-color: #4b5465 !important;
  border-color: #4b5465 !important;
}
.v-application .secondary--text.text--lighten-2 {
  color: #4b5465 !important;
  caret-color: #4b5465 !important;
}
.v-application .secondary.lighten-1 {
  background-color: #343d4d !important;
  border-color: #343d4d !important;
}
.v-application .secondary--text.text--lighten-1 {
  color: #343d4d !important;
  caret-color: #343d4d !important;
}
.v-application .secondary.darken-1 {
  background-color: #081221 !important;
  border-color: #081221 !important;
}
.v-application .secondary--text.text--darken-1 {
  color: #081221 !important;
  caret-color: #081221 !important;
}
.v-application .secondary.darken-2 {
  background-color: #00000a !important;
  border-color: #00000a !important;
}
.v-application .secondary--text.text--darken-2 {
  color: #00000a !important;
  caret-color: #00000a !important;
}
.v-application .secondary.darken-3 {
  background-color: #000000 !important;
  border-color: #000000 !important;
}
.v-application .secondary--text.text--darken-3 {
  color: #000000 !important;
  caret-color: #000000 !important;
}
.v-application .secondary.darken-4 {
  background-color: #000000 !important;
  border-color: #000000 !important;
}
.v-application .secondary--text.text--darken-4 {
  color: #000000 !important;
  caret-color: #000000 !important;
}
.v-application .accent {
  background-color: #616161 !important;
  border-color: #616161 !important;
}
.v-application .accent--text {
  color: #616161 !important;
  caret-color: #616161 !important;
}
.v-application .accent.lighten-5 {
  background-color: #e6e6e6 !important;
  border-color: #e6e6e6 !important;
}
.v-application .accent--text.text--lighten-5 {
  color: #e6e6e6 !important;
  caret-color: #e6e6e6 !important;
}
.v-application .accent.lighten-4 {
  background-color: #c9c9c9 !important;
  border-color: #c9c9c9 !important;
}
.v-application .accent--text.text--lighten-4 {
  color: #c9c9c9 !important;
  caret-color: #c9c9c9 !important;
}
.v-application .accent.lighten-3 {
  background-color: #aeaeae !important;
  border-color: #aeaeae !important;
}
.v-application .accent--text.text--lighten-3 {
  color: #aeaeae !important;
  caret-color: #aeaeae !important;
}
.v-application .accent.lighten-2 {
  background-color: #949494 !important;
  border-color: #949494 !important;
}
.v-application .accent--text.text--lighten-2 {
  color: #949494 !important;
  caret-color: #949494 !important;
}
.v-application .accent.lighten-1 {
  background-color: #7a7a7a !important;
  border-color: #7a7a7a !important;
}
.v-application .accent--text.text--lighten-1 {
  color: #7a7a7a !important;
  caret-color: #7a7a7a !important;
}
.v-application .accent.darken-1 {
  background-color: #494949 !important;
  border-color: #494949 !important;
}
.v-application .accent--text.text--darken-1 {
  color: #494949 !important;
  caret-color: #494949 !important;
}
.v-application .accent.darken-2 {
  background-color: #333333 !important;
  border-color: #333333 !important;
}
.v-application .accent--text.text--darken-2 {
  color: #333333 !important;
  caret-color: #333333 !important;
}
.v-application .accent.darken-3 {
  background-color: #1e1e1e !important;
  border-color: #1e1e1e !important;
}
.v-application .accent--text.text--darken-3 {
  color: #1e1e1e !important;
  caret-color: #1e1e1e !important;
}
.v-application .accent.darken-4 {
  background-color: #040404 !important;
  border-color: #040404 !important;
}
.v-application .accent--text.text--darken-4 {
  color: #040404 !important;
  caret-color: #040404 !important;
}
.v-application .error {
  background-color: #b64c4c !important;
  border-color: #b64c4c !important;
}
.v-application .error--text {
  color: #b64c4c !important;
  caret-color: #b64c4c !important;
}
.v-application .error.lighten-5 {
  background-color: #ffd4cd !important;
  border-color: #ffd4cd !important;
}
.v-application .error--text.text--lighten-5 {
  color: #ffd4cd !important;
  caret-color: #ffd4cd !important;
}
.v-application .error.lighten-4 {
  background-color: #ffb7b1 !important;
  border-color: #ffb7b1 !important;
}
.v-application .error--text.text--lighten-4 {
  color: #ffb7b1 !important;
  caret-color: #ffb7b1 !important;
}
.v-application .error.lighten-3 {
  background-color: #ff9c97 !important;
  border-color: #ff9c97 !important;
}
.v-application .error--text.text--lighten-3 {
  color: #ff9c97 !important;
  caret-color: #ff9c97 !important;
}
.v-application .error.lighten-2 {
  background-color: #f2817d !important;
  border-color: #f2817d !important;
}
.v-application .error--text.text--lighten-2 {
  color: #f2817d !important;
  caret-color: #f2817d !important;
}
.v-application .error.lighten-1 {
  background-color: #d46664 !important;
  border-color: #d46664 !important;
}
.v-application .error--text.text--lighten-1 {
  color: #d46664 !important;
  caret-color: #d46664 !important;
}
.v-application .error.darken-1 {
  background-color: #993235 !important;
  border-color: #993235 !important;
}
.v-application .error--text.text--darken-1 {
  color: #993235 !important;
  caret-color: #993235 !important;
}
.v-application .error.darken-2 {
  background-color: #7c1520 !important;
  border-color: #7c1520 !important;
}
.v-application .error--text.text--darken-2 {
  color: #7c1520 !important;
  caret-color: #7c1520 !important;
}
.v-application .error.darken-3 {
  background-color: #5f000a !important;
  border-color: #5f000a !important;
}
.v-application .error--text.text--darken-3 {
  color: #5f000a !important;
  caret-color: #5f000a !important;
}
.v-application .error.darken-4 {
  background-color: #450000 !important;
  border-color: #450000 !important;
}
.v-application .error--text.text--darken-4 {
  color: #450000 !important;
  caret-color: #450000 !important;
}
.v-application .info {
  background-color: #5293c9 !important;
  border-color: #5293c9 !important;
}
.v-application .info--text {
  color: #5293c9 !important;
  caret-color: #5293c9 !important;
}
.v-application .info.lighten-5 {
  background-color: #e4ffff !important;
  border-color: #e4ffff !important;
}
.v-application .info--text.text--lighten-5 {
  color: #e4ffff !important;
  caret-color: #e4ffff !important;
}
.v-application .info.lighten-4 {
  background-color: #c6ffff !important;
  border-color: #c6ffff !important;
}
.v-application .info--text.text--lighten-4 {
  color: #c6ffff !important;
  caret-color: #c6ffff !important;
}
.v-application .info.lighten-3 {
  background-color: #a9e5ff !important;
  border-color: #a9e5ff !important;
}
.v-application .info--text.text--lighten-3 {
  color: #a9e5ff !important;
  caret-color: #a9e5ff !important;
}
.v-application .info.lighten-2 {
  background-color: #8cc9ff !important;
  border-color: #8cc9ff !important;
}
.v-application .info--text.text--lighten-2 {
  color: #8cc9ff !important;
  caret-color: #8cc9ff !important;
}
.v-application .info.lighten-1 {
  background-color: #6faee5 !important;
  border-color: #6faee5 !important;
}
.v-application .info--text.text--lighten-1 {
  color: #6faee5 !important;
  caret-color: #6faee5 !important;
}
.v-application .info.darken-1 {
  background-color: #3279ad !important;
  border-color: #3279ad !important;
}
.v-application .info--text.text--darken-1 {
  color: #3279ad !important;
  caret-color: #3279ad !important;
}
.v-application .info.darken-2 {
  background-color: #006193 !important;
  border-color: #006193 !important;
}
.v-application .info--text.text--darken-2 {
  color: #006193 !important;
  caret-color: #006193 !important;
}
.v-application .info.darken-3 {
  background-color: #004979 !important;
  border-color: #004979 !important;
}
.v-application .info--text.text--darken-3 {
  color: #004979 !important;
  caret-color: #004979 !important;
}
.v-application .info.darken-4 {
  background-color: #003360 !important;
  border-color: #003360 !important;
}
.v-application .info--text.text--darken-4 {
  color: #003360 !important;
  caret-color: #003360 !important;
}
.v-application .success {
  background-color: #00e676 !important;
  border-color: #00e676 !important;
}
.v-application .success--text {
  color: #00e676 !important;
  caret-color: #00e676 !important;
}
.v-application .success.lighten-5 {
  background-color: #ceffff !important;
  border-color: #ceffff !important;
}
.v-application .success--text.text--lighten-5 {
  color: #ceffff !important;
  caret-color: #ceffff !important;
}
.v-application .success.lighten-4 {
  background-color: #afffe4 !important;
  border-color: #afffe4 !important;
}
.v-application .success--text.text--lighten-4 {
  color: #afffe4 !important;
  caret-color: #afffe4 !important;
}
.v-application .success.lighten-3 {
  background-color: #8fffc8 !important;
  border-color: #8fffc8 !important;
}
.v-application .success--text.text--lighten-3 {
  color: #8fffc8 !important;
  caret-color: #8fffc8 !important;
}
.v-application .success.lighten-2 {
  background-color: #6dffac !important;
  border-color: #6dffac !important;
}
.v-application .success--text.text--lighten-2 {
  color: #6dffac !important;
  caret-color: #6dffac !important;
}
.v-application .success.lighten-1 {
  background-color: #47ff91 !important;
  border-color: #47ff91 !important;
}
.v-application .success--text.text--lighten-1 {
  color: #47ff91 !important;
  caret-color: #47ff91 !important;
}
.v-application .success.darken-1 {
  background-color: #00c95c !important;
  border-color: #00c95c !important;
}
.v-application .success--text.text--darken-1 {
  color: #00c95c !important;
  caret-color: #00c95c !important;
}
.v-application .success.darken-2 {
  background-color: #00ad43 !important;
  border-color: #00ad43 !important;
}
.v-application .success--text.text--darken-2 {
  color: #00ad43 !important;
  caret-color: #00ad43 !important;
}
.v-application .success.darken-3 {
  background-color: #009129 !important;
  border-color: #009129 !important;
}
.v-application .success--text.text--darken-3 {
  color: #009129 !important;
  caret-color: #009129 !important;
}
.v-application .success.darken-4 {
  background-color: #00760d !important;
  border-color: #00760d !important;
}
.v-application .success--text.text--darken-4 {
  color: #00760d !important;
  caret-color: #00760d !important;
}
.v-application .warning {
  background-color: #ffc107 !important;
  border-color: #ffc107 !important;
}
.v-application .warning--text {
  color: #ffc107 !important;
  caret-color: #ffc107 !important;
}
.v-application .warning.lighten-5 {
  background-color: #ffffae !important;
  border-color: #ffffae !important;
}
.v-application .warning--text.text--lighten-5 {
  color: #ffffae !important;
  caret-color: #ffffae !important;
}
.v-application .warning.lighten-4 {
  background-color: #ffff91 !important;
  border-color: #ffff91 !important;
}
.v-application .warning--text.text--lighten-4 {
  color: #ffff91 !important;
  caret-color: #ffff91 !important;
}
.v-application .warning.lighten-3 {
  background-color: #ffff74 !important;
  border-color: #ffff74 !important;
}
.v-application .warning--text.text--lighten-3 {
  color: #ffff74 !important;
  caret-color: #ffff74 !important;
}
.v-application .warning.lighten-2 {
  background-color: #fff956 !important;
  border-color: #fff956 !important;
}
.v-application .warning--text.text--lighten-2 {
  color: #fff956 !important;
  caret-color: #fff956 !important;
}
.v-application .warning.lighten-1 {
  background-color: #ffdd37 !important;
  border-color: #ffdd37 !important;
}
.v-application .warning--text.text--lighten-1 {
  color: #ffdd37 !important;
  caret-color: #ffdd37 !important;
}
.v-application .warning.darken-1 {
  background-color: #e0a600 !important;
  border-color: #e0a600 !important;
}
.v-application .warning--text.text--darken-1 {
  color: #e0a600 !important;
  caret-color: #e0a600 !important;
}
.v-application .warning.darken-2 {
  background-color: #c18c00 !important;
  border-color: #c18c00 !important;
}
.v-application .warning--text.text--darken-2 {
  color: #c18c00 !important;
  caret-color: #c18c00 !important;
}
.v-application .warning.darken-3 {
  background-color: #a27300 !important;
  border-color: #a27300 !important;
}
.v-application .warning--text.text--darken-3 {
  color: #a27300 !important;
  caret-color: #a27300 !important;
}
.v-application .warning.darken-4 {
  background-color: #855a00 !important;
  border-color: #855a00 !important;
}
.v-application .warning--text.text--darken-4 {
  color: #855a00 !important;
  caret-color: #855a00 !important;
}</style><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-app="true" data-server-rendered="true" id="app" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><div data-v-7b23e68f><header class="top-layout v-sheet theme--light v-toolbar v-app-bar v-app-bar--fixed secondary" style="height:56px;margin-top:0px;transform:translateY(0px);left:0px;right:0px;" data-v-7b23e68f><div class="v-toolbar__content" style="height:56px;"><div class="header-container" data-v-7b23e68f><a href="/" class="logo-container active" data-v-7b23e68f><img src="/assets/img/Th2Logo_full_white.37da6040.png" data-v-7b23e68f></a><div class="search-container" data-v-e54dafa2 data-v-7b23e68f><button class="search-btn" data-v-e54dafa2><i aria-hidden="true" class="v-icon notranslate mdi mdi-magnify theme--dark" data-v-e54dafa2></i><span data-v-e54dafa2>
    Search
  </span></button><div class="v-dialog__container" data-v-e54dafa2><!----></div></div><div class="header-btns" data-v-7b23e68f><a href="https://github.com/th2-net/th2-docs" target="_blank" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-7b23e68f><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--dark" data-v-7b23e68f></i></span></a><button type="button" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-a8cf542a data-v-7b23e68f><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-brightness-5 theme--dark" data-v-a8cf542a></i></span></button><button type="button" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-7b23e68f><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-menu theme--dark" data-v-7b23e68f></i></span></button></div></div></div></header><aside class="layout__aside--left--sm pt-16 px-5 v-navigation-drawer v-navigation-drawer--close v-navigation-drawer--fixed v-navigation-drawer--is-mobile theme--light" style="height:100%;top:0px;transform:translateX(-100%);width:90vw;min-width:300px;" data-v-7b23e68f><div class="v-navigation-drawer__content"><aside class="pt-5 content-tree-panel pl-3" data-v-34f442ea data-v-7b23e68f><div class="sticky-tree px-3 ml-n3" data-v-34f442ea><!----><div class="py-2" data-v-34f442ea><a href="/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea> Home </span></div></a></div><div class="py-2" data-v-34f442ea><a href="/getting-started/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Getting started
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/requirements/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								System requirements
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/install-th2/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Install th2
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/create-th2-env/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Create th2 environment
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/fundamentals/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Fundamentals
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/architecture/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Architecture
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/th2-net-on-github/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-net on GitHub
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/th2-common/" aria-current="page" class="active--exact active nuxt-link-exact-active" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-common
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/key-concepts/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Key concepts
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/script/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Script
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/infrastructure/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Infrastructure
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/th2-infra-repository/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/th2-infra-schema/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra-schema
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/infra-components/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra components
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/core/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Core
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/core/th2-estore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-estore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/core/th2-mstore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-mstore
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/modules/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Modules
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/conn/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								conn
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/codec/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								codec
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/check1/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check1
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/check2-recon/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check2-recon
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/cookbook/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              ðŸ“– Cookbook
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/quick-setup/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Quick th2 setup
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/run-box-outside-cluster/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								How to run a box outside the cluster
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/chain-verification/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Chain Verification
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/readme/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Readme Files
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/th2-infra/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2 infra
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-inframgr/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								infra-mgr
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-infra-operator/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								infra-operator
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-mstore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								mstore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-estore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								estore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/check1/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check1
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/check2recon/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check2-recon
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/codec/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								codec
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/conn/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								conn
							</div></a></div></div></div></div></div></div></div></aside></div><div class="v-navigation-drawer__border"></div></aside><main class="v-main" style="padding-top:1400px;padding-right:0px;padding-bottom:0px;padding-left:0px;" data-v-7b23e68f><div class="v-main__wrap"><div class="layout--full" data-v-7b23e68f><aside class="pt-5 content-tree-panel layout__aside--left--lg" data-v-34f442ea data-v-7b23e68f><div class="sticky-tree px-3 ml-n3" data-v-34f442ea><!----><div class="py-2" data-v-34f442ea><a href="/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea> Home </span></div></a></div><div class="py-2" data-v-34f442ea><a href="/getting-started/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Getting started
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/requirements/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								System requirements
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/install-th2/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Install th2
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/getting-started/create-th2-env/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Create th2 environment
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/fundamentals/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Fundamentals
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/architecture/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Architecture
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/th2-net-on-github/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-net on GitHub
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/th2-common/" aria-current="page" class="active--exact active nuxt-link-exact-active" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-common
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/key-concepts/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Key concepts
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/fundamentals/script/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Script
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/infrastructure/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Infrastructure
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/th2-infra-repository/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/th2-infra-schema/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra-schema
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/infrastructure/infra-components/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-infra components
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/core/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Core
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/core/th2-estore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-estore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/core/th2-mstore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2-mstore
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/modules/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Modules
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/conn/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								conn
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/codec/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								codec
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node"><div class="v-treeview-node__root"><button type="button" class="v-icon notranslate v-treeview-node__toggle v-icon--link mdi mdi-menu-down theme--light"></button><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/check1/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check1
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/modules/check2-recon/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check2-recon
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/cookbook/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              ðŸ“– Cookbook
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/quick-setup/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Quick th2 setup
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/run-box-outside-cluster/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								How to run a box outside the cluster
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/cookbook/chain-verification/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								Chain Verification
							</div></a></div></div></div></div></div></div><div class="py-2" data-v-34f442ea><a href="/readme/" class="main-section" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea><span data-v-34f442ea>
              Readme Files
            </span></div></a><div class="v-treeview ml-n3 v-treeview--dense theme--light" data-v-34f442ea><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/th2-infra/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								th2 infra
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-inframgr/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								infra-mgr
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-infra-operator/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								infra-operator
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-mstore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								mstore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/readme-estore/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								estore
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/check1/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check1
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/check2recon/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								check2-recon
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/codec/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								codec
							</div></a></div></div></div></div><div aria-expanded="false" class="v-treeview-node v-treeview-node--leaf"><div class="v-treeview-node__root"><div class="v-treeview-node__level"></div><div class="v-treeview-node__content"><div class="v-treeview-node__label"><a href="/readme/conn/" data-v-34f442ea><div class="tree__path-name" data-v-34f442ea>
								conn
							</div></a></div></div></div></div></div></div></div></aside><div class="layout__doc-page"><div class="container layout__main space-bottom"><article><!----><!----><div class="doc-article"><h1 id="th2-common"><a href="#th2-common" aria-hidden="true">#</a>th2-common</h1><p><code>th2-common</code> is a library used for enabling transfer of data in th2 and is required when setting up communications for a module.</p><p>The library is currently available in 3 languages: Java, Kotlin and Python. 
Links to the open source repositories:</p><ol><li>Java &amp; Kotlin - <a href="https://github.com/th2-net/th2-common-j" target="_blank" rel="nofollow noopener noreferrer">GitHub - th2-net/th2-common-j</a></li><li>Python - <a href="https://github.com/th2-net/th2-common-py" target="_blank" rel="nofollow noopener noreferrer">GitHub - th2-net/th2-common-py</a></li></ol><p>To be exact, these are some of the things the common library is used for:</p><ol><li><p>set up RabbitMQ consumer and producer </p></li><li><p>set up gRPC client and server</p></li><li><p>set up prometheus client</p><ul><li>collect metrics on loads to and from RabbitMQ,</li><li>collect metrics about gRPC loads</li><li>collect message metrics</li><li>collect event metrics</li><li>send metrics to Prometheus</li></ul></li></ol><p>Some of the above activities are not automated and requires initial setting up by the user.</p><h2 id="commonfactory-class"><a href="#commonfactory-class" aria-hidden="true">#</a>CommonFactory class</h2><p><code>CommonFactory</code> is a class, that allows user to execute activities, related to communication between component developed and other th2 components.</p><p>Users should create instance of <code>CommonFactory</code>  in order to integrate a component into the th2 cluster. 
<code>CommonFactory</code> contains functions that will access configuration files to obtain the required settings which allows the module to make the connections with solutions such as RabbitMQ, gRPC or Prometheus.</p><p>There are two methods for accessing the configuration files.</p><ol><li>User creates the configuration files and then provides the path to these files</li><li>Access config maps from the Kubernetes cluster</li></ol><p>The configuration files (list below) required by a module to read:</p><ol><li>A <strong>RabbitMQ</strong> config from the <code>rabbitMQ.json</code> file</li><li>A <strong>message's router configuration</strong> from the <code>mq.json</code> file</li><li>A <strong>gRPC router configuration</strong> from the <code>grpc_router.json</code> file</li><li>A <strong>gRPC configuration</strong> from the <code>grpc.json</code> file</li><li>A <strong>Cradle configuration</strong> from the <code>cradle.json</code> file</li></ol><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left red--text text--darken-4" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert theme--light red--text text--darken-4"></i><div class="v-alert__content"><p>These filenames can be customized, but it is recommended that file names remains unchanged. 
<code>CommonFactory</code> variant on Java has them hardcoded.
If files names were to be changed you should change them in the imported <code>CommonFactory</code> library for Java as well.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><h2 id="setting-up-an-instance-of-common-factory"><a href="#setting-up-an-instance-of-common-factory" aria-hidden="true">#</a>Setting up an instance of Common Factory</h2><p>To gain access to the required configuration files, a user may choose to set up the instance named factory, of class <code>CommonFactory</code>, in the following ways. 
Several examples are provided below.</p><h3 id="option-1-user-creates-the-configuration-files-and-then-provides-the-path-to-these-files"><a href="#option-1-user-creates-the-configuration-files-and-then-provides-the-path-to-these-files" aria-hidden="true">#</a>Option 1: User creates the configuration files and then provides the path to these files</h3><p>Create instance of <code>CommonFactory</code> and provide access to the config files. 
This should be specified during the start of the application.</p><ol><li>Create an instance with configs files in the default path (<code>/var/th2/config/*</code>)</li></ol><div class="remark-highlight"><pre class="language-java"><code class="language-java"><span class="token keyword">var</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><ol start="2"><li>Provide custom paths as shown below</li></ol><p>The <code>.json</code> config files should created and be placed in directories in the path.</p><div class="remark-highlight"><pre class="language-shell"><code class="language-shell">var factory <span class="token operator">=</span> new CommonFactory<span class="token punctuation">(</span>rabbitMQ, routerMQ, routerGRPC, cradle, custom, prometheus, dictionariesDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><ol start="3"><li>Create instance with configs from command line arguments.<br>
The arguments from Group1 (see below) will access the user made config files. 
<code>args</code> is a string array of command line arguments.
<code>.createFromArguments</code> returns a</li></ol><div class="remark-highlight"><pre class="language-java"><code class="language-java"><span class="token keyword">var</span> factory <span class="token operator">=</span> <span class="token class-name">CommonFactory</span><span class="token punctuation">.</span><span class="token function">createFromArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><h3 id="option-2-access-config-files-from-the-kubernetes-cluster"><a href="#option-2-access-config-files-from-the-kubernetes-cluster" aria-hidden="true">#</a>Option 2: Access config files from the Kubernetes cluster</h3><p>Either use the <code>.createFromArguments()</code> method with arguments from group 2 or the <code>.createFromKubernetes()</code> method to access configuration files in the config maps of Kubernetes cluster</p><div class="remark-highlight"><pre class="language-java"><code class="language-java"><span class="token keyword">var</span> factory <span class="token operator">=</span> <span class="token class-name">CommonFactory</span><span class="token punctuation">.</span><span class="token function">createFromKubernetes</span><span class="token punctuation">(</span>namespace<span class="token punctuation">,</span> boxName<span class="token punctuation">,</span> contextName<span class="token punctuation">,</span> dictionaries<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Two objects will be created:</p><ul><li><code>generated_configs</code> directory - this directory stores <code>.json</code> configuration files from Kubernetes;<ul><li>These files are overridden when <code>CommonFactory.createFromKubernetes(namespace, boxName)</code> and <code>CommonFactory.createFromKubernetes(namespace, boxName, contextName)</code> are invoked again.</li></ul></li><li><code>factory</code> - the tool object that contains interfaces which are used to set up connections with th2 services.</li></ul><p>There are requirements that must be met when creating the object <code>factory</code> using Kubernetes:</p><ol><li>It is necessary to have Kubernetes configuration written in <code>~/.kube/config</code>. See more on kubectl configuration <a href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/" target="_blank" rel="nofollow noopener noreferrer">here</a>.</li><li>User needs to have authentication with service account token that has the necessary access to read custom resources (CRs) and secrets from the specified namespace.<ul><li>Common Factory will look for RabbitMQ and Cassandra secret name and password key.</li></ul></li></ol><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>A custom resource (or CR) is an extension of the Kubernetes API, that represents a customization of a particular Kubernetes installation.</p><p>A secret is an object that contains a small amount of sensitive data such as a password, a token, or a key. 
Secrets are similar to config maps but are specifically intended to hold confidential data.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><h2 id="run-component"><a href="#run-component" aria-hidden="true">#</a>Run component</h2><p>In first attempts of running your component, you probably will run it as <a href="../../cookbook/run-box-outside-cluster/">external box</a>. 
Depending on the method used to create the component, you can run it in different ways.</p><h3 id="option-1-run-without-arguments"><a href="#option-1-run-without-arguments" aria-hidden="true">#</a>Option 1: Run without arguments</h3><p>The main commands to run the box are slightly different for different programming languages:</p><ul><li>Java: <code>gradle run</code></li><li>Python: <code>python run.py</code></li></ul><h3 id="option-2-run-with-arguments"><a href="#option-2-run-with-arguments" aria-hidden="true">#</a>Option 2: Run with arguments</h3><p>If you have not specified configs for <code>th2-common</code> to connect to the th2, you should specify them along with arguments in terminal. 
You can use one of the groups of arguments provided below.</p><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>Arguments from different groups cannot be used together.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><p>Local files configuration arguments:</p><ul><li><code>--rabbitConfiguration</code> â€“ a path to the <code>.json</code> file with RabbitMQ configuration</li><li><code>--messageRouterConfiguration</code> â€“ a path to the <code>.json</code> file with configuration for MessageRouter</li><li><code>--grpcRouterConfiguration</code> â€“ a path to the <code>.json</code> file with configuration for gRPCRouter</li><li><code>--cradleConfiguration</code> â€“ a path to the <code>.json</code> file with configuration for Cradle</li><li><code>--customConfiguration</code> â€“ a path to the <code>.json</code> file with a custom configuration</li><li><code>--dictionariesDir</code> â€“ a path to the directory with encoded dictionary files</li><li><code>--prometheusConfiguration</code> â€“ a path to the <code>.json</code> file with a configuration for Prometheus metrics server</li><li><code>--boxConfiguration</code> â€“ a path to the <code>.json</code> file with external box</li><li><code>-c/</code> and <code>--configs</code> â€“ a folder with <code>.json</code> files for schema configurations with following names:</li></ul><p>1) rabbitMq.json â€“ a configuration file for RabbitMQ</p><p>2) mq.json â€“ a configuration file for MessageRouter</p><p>3) grpc.json â€“ a configuration file for gRPCRouter</p><p>4) cradle.json â€“ a configuration file for the Cradle API</p><p>5) custom.json â€“ custom configuration</p><p>Kubernetes-based configuration arguments:</p><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>when using these arguments, prior installation and configuration of kubectl is required</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><ul><li><p><code>--namespace</code> â€“ the namespace in Kubernetes to search for config maps</p></li><li><p><code>--boxName</code> â€“ the name of the target th2 box placed in the specified Kubernetes namespace</p></li><li><p><code>--contextName</code> â€“ the context name to search connection parameters in kubeconfig</p></li><li><p><code>--dictionaries</code> â€“ the mapping between a dictionary in infra-schema and a dictionary type specified in the following format: <code>--dictionaries &lt;dictionary name&gt;=&lt;dictionary type&gt; [&lt;dictionary name&gt;=&lt;dictionary type&gt;]</code>.
This argument is provided  when dictionaries are required to start a specific box.</p></li></ul><p>A CLI command example:</p><div class="remark-highlight"><pre class="language-java"><code class="language-java">gradle run <span class="token operator">--</span>args<span class="token operator">=</span>'<span class="token operator">--</span>namespace myNamespace <span class="token operator">--</span>boxName myExternalBox <span class="token operator">--</span>contextName myContext'
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>With these parameters, your component will connect to the destination Kubernetes cluster and namespace, and find the right entry point (that is external box itself) to act from.</p><p>Also, there are special ConfigMaps in the <em>schema</em> namespace with the parameters for connecting to the th2 infrastructure. 
<code>th2-common</code> will save it automatically in the repository of the box you are running.</p><h2 id="th2-common-integrations-configuration"><a href="#th2-common-integrations-configuration" aria-hidden="true">#</a>th2-common integrations configuration</h2><p>th2 as a framework based on open-source technologies, made by other developers.
They allows data storage, interchange and displaying.</p><h3 id="rabbitmq"><a href="#rabbitmq" aria-hidden="true">#</a>RabbitMQ</h3><p>RabbitMQ is a powerful engine for message queues. 
It allows you to be confident that some component of the system will receive a message in any case.</p><p>After RabbitMQ is installed in your th2 cluster, this service is accessible within Kubernetes private network and for external systems. 
Configuration for connecting to the RabbitMQ service can be applied automatically or set manually. 
It depends on how you created the instance of <code>CommonFactory</code>.</p><p>After you created <code>factory</code> object, you can get routers for receiving and sending messages.</p><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>Code examples here are given in Java. 
And it can be different for other programming languages.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><div class="remark-highlight"><pre class="language-java"><code class="language-java"><span class="token keyword">var</span> messageRouter <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">getMessageRouterParsedBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> rawRouter <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">getMessageRouterRawBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> eventRouter <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">getEventBatchRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>This example creates 3 different routers for 3 batches:</p><ul><li><code>messageRouter</code> is working with <code>MessageBatch</code>;</li><li><code>rawRouter</code> is working with <code>RawMessageBatch</code>;</li><li><code>eventRouter</code> is working with <code>EventBatch</code>.</li></ul><p>These batches differ from each other by content type.</p><p>With the router created, you can subscribe to pins (by specifying the callback function) or to send data that the router works with:</p><div class="remark-highlight"><pre class="language-java"><code class="language-java">router<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> attrs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// subscribe to only one pin</span>
router<span class="token punctuation">.</span><span class="token function">subscribeAll</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> attrs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// subscribe to one or several pins</span>
router<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> attrs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// send to only one pin</span>
router<span class="token punctuation">.</span><span class="token function">sendAll</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> attrs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// send to one or several pins</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p><code>attrs...</code> is non-mandatory list of pin attributes to filter pins for action. 
If these attributes are not specified pins will be filtered by default attributes. 
Default attributes depend on the router and action types:</p><ul><li><code>message_parsed_batch_router</code><ul><li>Subscribe: <code>subscribe</code>, <code>parsed</code></li><li>Send: <code>publish</code>, <code>parsed</code></li></ul></li><li><code>message_raw_batch_router</code><ul><li>Subscribe: <code>subscribe</code>, <code>raw</code></li><li>Send: <code>publish</code>, <code>raw</code></li></ul></li><li><code>event_batch_router</code><ul><li>Subscribe: <code>subscribe</code>, <code>event</code></li><li>Send: <code>publish</code>, <code>event</code></li></ul></li></ul><p>If you want to use default pins for router, specify <code>callback</code> or <code>message</code> only as first parameter:</p><div class="remark-highlight"><pre class="language-java"><code class="language-java">router<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">subscribeAll</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">sendAll</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>If you want to provide some custom attributes, you will need to list them as strings after the first parameter:</p><div class="remark-highlight"><pre class="language-java"><code class="language-java">router<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token string">&quot;subscribe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;parsed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">subscribeAll</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token string">&quot;subscribe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;event&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&quot;publish&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;raw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">sendAll</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&quot;publish&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;raw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Please be careful that all messages are filtered on the level of <code>th2-common</code>. 
So Kubernetes do not affect on the message delivery. 
And RabbitMQ only provides channels for messages.</p><p>There is a list of predefined Pinâ€™s attributes for th2 framework. 
And it will be better for you, if you follow architecture recommendations by the th2 team.</p><p>Let you know, that this Pinâ€™s attributes system is very flexible and you can define any attributes you want. 
But keep in mind, that these attributes must be specified in <code>subscribe()</code> and <code>send()</code> methods calls.</p><p>For example, you can see how two th2 modules send messages to each other. 
Keep in mind, that every Pin is connected to only 1 Pin in another module.</p><p><img alt="RabbitMQ workflow" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1920 536' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-de8fe5aa39c18d19d760d1700ebd3eb6'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-de8fe5aa39c18d19d760d1700ebd3eb6)' width='1920' height='536' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAASCAYAAADrL9giAAAACXBIWXMAAAsSAAALEgHS3X78AAAHE0lEQVRYw81YaUyURxiePVgWll1gOV1YbgSBovVoPBAai1aUVIO2BY%2b2NEBBigqmP7AiaqVFlHKkWi0mhmA4rCjWRmG5S4gNh5hAwHoBa0NBUJAWLYJM3xnmWxZBimZ/OMnDzM7xHs/7zvGB0JtRBAApQAzQ1%2brnA0wABqyf1CJWkyIEmLIxsdZ6sS6NMwJYsNoYIGe1iBltDpCwtowZRAzXA1iz%2bVK2ntRmAB6TzWPOEBmLAG8BnNlcjoh5AC%2bAK8AbsIzN5TEdpG8um7cQsBLgwtaKmU2GTI%2bEQV%2bLVCrIBuAmEAiUdnZ2JkyYJzOECHHh8XjLjYyMPJlCR0YCmbsU1rkbGhoS5e%2bQ3ywyBA6ABWKx%2bG19fX1OppMWAYQoe4AHn89fIpFIvJmjLow8UqwIMSDD0cDAwJM5OUcrQITguUSHSCQiBHqBLCEbUzI5DmCjvbGxsSOTr2Q%2bWnJChBYWFiItw/TAYT2Wmkgul5O2HYuUAwgScAvBsTlcVujp6Vkz0jTF3NzclBmssLS0lE2XYuAYyQo3Mgdk2DFiuCIFHc5MtxLaLiyq2usdmX1OECTL1871pqYmWUVFxVoggxIxf/585OzsTI0JCwuT19TUrG1tbaXsgjP8kJAQOi8%2bPt6%2brq7On7QxxkgoFJJ%2bXlxcHF1bXFy8vLa2ljCOVq9eLWBEU/j7%2b9M5iYmJdjBnDZvDg4jRcSKPlJMnTy6or68nGYZiYmL43PqMjAxqw%2bXLl33Ly8vdSTs4OFgzvnjxYio/PDxcUVpaus7Pz48GD/ROOH7x4kUqpLKy0rWsrOwSMEr2vAk4IgdGSXQlYNS7IODK%2bvXrSVrLIBJyFl1pVFRUcFVVVSFpw3wzyB7SL3d3dydrTfPz87OKiop2kcja29ubs3OCzgEZZI5RdHT0RyDjApENGSYHGaRfDluS1LLU1NQEsC2dZKuNjY0Fyzo5BIjTcaawsDCaZK2tra05Ny6TyUh2SYCUdRDcSxA0uu%2bTk5OnTQJChILmnVTKbQcUGhrKtW3Jn4CAAO35iB1GM6We9MW0fYluqxnGxYy0lxUZ0zNTob75%2bPhM7uXSjBRgSKR1nRgwiCGahrDQytXV1ZCNc2P6EDGD9PR0mlpwGCF303Febm0T8/qWIl7e3m3CD5Z5UebdbC0m6YaM0NgAW447oTXXGmQCaYusra0lSqWSHLwS6DMyNTU1gvOCu/qIfRKFQqF9wou1ZUFADSDtNddjWlrahBHgAK3hFJ6WNjCOP9NvUlpaWib9HouYctULJg5%2brSNcLqc17FUEp7iATeCzA1jzG7Yjaes5ODiIEhISaJA2btyoHxgYSM4kAZAhIEVrLf9FWXBTUeVAIMX/FkuriYyM3fOVS3W5Knl/4gEPrs91rtu06zjnn0cgBY5Ciu7tyKlp0/j2uR08vm2mEvRqxczO3Wa6DNZZgYNN8xo7ezZnb%2b%2bDnsER0NTX2/ukID/vENv3KDIycnK26FPnhMzJo4BvAFk4AoXR8QjEex3nT58%2bTYlbsszHpO5a7XePe7sG2ppvnN25O44cyqi5uZmnUwJycnKowKiYWLs7f9zEVXef4qCsO8NXbw7hPzs78LdHjpLXFzp//vzk7YEmEXAYkAf4BXAC4AWQvmoG7Nixg3NOWl5a0jQKgchuGMQPISINdb/3b/s0lGZlUlISX2cElJSUUKXfJafYDz7ufxpbeH804HjbWFSB%2bll/fz8uKCigBMDdzddOxcLsbBJljoBYvBO6IxCG9g3AMGAVHQtH/LGxsVnZAm8EasvK99bO6e/reZBa3o3f/6FtZNfPnSN9D/txTvYZPzKel5enOwJAGFW6OWS7Zce9O4NdwxhnVnU/7xzCuLP97mj8vkSl9huCI%2bB6YyPCn48TMPoFfx/eA2%2bZ3Tw8Fik4%2bjyC1/IsQrCBzg1D/MzMzFnZAoce1eE0z9v6n4FHf59rGcabsm7/m1LRNwY68Y8njlMCcnNzdUdAUFAQ6v6riypOPpLi0X6rtajjdhuG%2bkpaesYCzmFfX98pa4cOL6UE4A/RKhyKVPgTlI%2b3okv4M1SM/cfv4p6vF/Jf4zwS/FZd/f1A/yPc9XgEDz15gm9cb7yw%2beMt5LGDjh07xtP5YRiyZStnqHDdhk3LuU/RL2N28qe5LpFKpaL9paqSNZXVNSVl1TW5V1Rl5643txZca2jKq29o/FWt7iRyEDyrZ03CihUrNO1Tp35aWKG6mp2XmxvI9R08eEi3zsO9q2nC89YV7mvyYlHCW8HTzMxMwV3ocHdPIqC7u5v29/Q8WNTR3p7Sfu/e/s6O9gN9fb0H7qvViWq1OmlgYMBjfE7PrIyGR4zmRrKysuI%2bjAhs4LvFAZ7T1Ah4HL0Z/90Ah3m6mPNigYcM5QPe%2bjJvb2851HL49JVNeV29QvkPauJDE/obKroAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="1920" data-src="/assets/static/rabbitmq_workflow.2665e34.9c999ed825544a5e5937a96f6f25f32b.png" data-srcset="/assets/static/rabbitmq_workflow.82a2fbd.9c999ed825544a5e5937a96f6f25f32b.png 480w, /assets/static/rabbitmq_workflow.cbab2cf.9c999ed825544a5e5937a96f6f25f32b.png 1024w, /assets/static/rabbitmq_workflow.2665e34.9c999ed825544a5e5937a96f6f25f32b.png 1920w" data-sizes="(max-width: 1920px) 100vw, 1920px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/rabbitmq_workflow.2665e34.9c999ed825544a5e5937a96f6f25f32b.png" class="g-image g-image--loaded" width="1920" alt="RabbitMQ workflow"></noscript></p><p>Sent message has the following lifecycle:</p><ol><li><code>th2-module-1</code> calls a method for sending message;</li><li><code>th2-common</code> in <code>th2-module-1</code> choose Pins to send message with. 
Pins are filtered by attributes given in <code>send</code> method call;</li><li>message is sent with RabbitMQ client in <code>th2-common</code> in <code>th2-module-1</code>;</li><li>message on RabbitMQ server is redirected to right endpoint (Pin on the <code>th2-module-2</code>)</li><li>message is received by RabbitMQ client in <code>th2-common</code> in <code>th2-module-2</code>;</li><li>message is filtered by its content with Pinâ€™s filters;</li><li><code>th2-common</code> choose callback to trigger by attributes of Pin-receiver provided in the method call for subscription.</li></ol><h2 id="grpc"><a href="#grpc" aria-hidden="true">#</a>gRPC</h2><p>gRPC is a high performance protocol for messaging between apps. 
And you can use it for integration of your th2 module to the system.</p><p>To use gRPC protocol it is needed to create gRPC client (for sending messages) and gRPC server (to receive messages) in your app. 
Basically, <code>th2-common</code> will do it for you.</p><p>If you use gRPC it is required to define an endpoint in extended settings for it in the <code>Th2Box</code> configuration:</p><div class="remark-highlight"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">extended-settings</span><span class="token punctuation">:</span>
  <span class="token key atrule">service</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
    <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> grpc
        <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
        <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">31179</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Endpoint parameters:</p><ul><li><code>name</code> must be <code>grpc</code></li><li><code>targetPort</code> - port on the Pod which gRPC server and client are listening</li><li><code>nodePort</code> - port on the global th2 service (provided by NGINX Ingress Controller). 
Requests to this port are redirected to the Podâ€™s <code>targetPort</code></li></ul><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>Code examples here are given in Python . And it can be different for other programming languages.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><p>First of all we need to get <code>grpc_router</code> from <code>CommonFactory</code> instance, like with routers for RabbitMQ.</p><div class="remark-highlight"><pre class="language-python"><code class="language-python">grpc_router <span class="token operator">=</span> factory<span class="token punctuation">.</span>grpc_router
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><h4 id="creating-client"><a href="#creating-client" aria-hidden="true">#</a>Creating client</h4><p>gRPC client sends requests to other modules. gRPC is a typed protocol. 
It means that you are not allowed to send any message you want. 
The message must have specific structure described in <code>.proto</code> files (e.g. <a href="https://github.com/th2-net/th2-grpc-common/blob/master/src/main/proto/th2_grpc_common/common.proto" target="_blank" rel="nofollow noopener noreferrer">https://github.com/th2-net/th2-grpc-common/blob/master/src/main/proto/th2_grpc_common/common.proto</a> ) and then transferred to the native programming language classes.</p><p>Most of th2 modules which uses gRPC have additional <code>th2-grpc-...</code> repository with described messages structure and prepared to generate Python or Java classes.</p><p>Generate special gRPC services class for component, you want to integrate with your module. And then provide it in your module.</p><div class="remark-highlight"><pre class="language-python"><code class="language-python">service <span class="token operator">=</span> router<span class="token punctuation">.</span>get_service<span class="token punctuation">(</span>Service<span class="token punctuation">)</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>And thatâ€™s all, now you can send messages to another component with gRPC. 
Just call needed method in service by name.</p><div class="remark-highlight"><pre class="language-python"><code class="language-python">service<span class="token punctuation">.</span>needed_method_name<span class="token punctuation">(</span>request<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Where parameters are:</p><ul><li><code>request</code> is the data that we send </li><li><code>timeout</code> is the timeout for the request</li></ul><h4 id="creating-server"><a href="#creating-server" aria-hidden="true">#</a>Creating server</h4><p>First of all we need to define gRPC messages structure via <code>.proto</code> files and transform it to the native class, like as described for gRPC client. 
For the new module we can use <a href="https://github.com/th2-net/th2-grpc-common" target="_blank" rel="nofollow noopener noreferrer">https://github.com/th2-net/th2-grpc-common</a>  as the template and change it for our needs.</p><div role="alert" class="v-alert my-3 v-sheet theme--light v-alert--border v-alert--text v-alert--border-left orange--text text--darken-3" data-v-e2b44c62><div class="v-alert__wrapper"><i aria-hidden="true" class="v-icon notranslate v-alert__icon mdi mdi-alert-circle theme--light orange--text text--darken-3"></i><div class="v-alert__content"><p>If you implement some existing module, you can use appropriate <code>th2-grpc-...</code> repository.</p></div><div class="v-alert__border v-alert__border--left"></div></div></div><p>After that generate service class and import it to the module. 
Use this class (<code>LibraryServicer</code> in example) to create your custom one (<code>GrpcHandler</code> in example) with overrided methods:</p><div class="remark-highlight"><pre class="language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">GrpcHandler</span><span class="token punctuation">(</span>LibraryServicer<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">method_1</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">method_n</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Create gRPC server with <code>router</code>:</p><div class="remark-highlight"><pre class="language-python"><code class="language-python">server <span class="token operator">=</span> router<span class="token punctuation">.</span>server
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>Create an instance of your custom gRPC handler and add services from it the local gRPC server with <code>add_LibraryServices_to_server()</code> method.</p><div class="remark-highlight"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> th2_grpc_library <span class="token keyword">import</span> library_pb2_grpc

library_pb2_grpc<span class="token punctuation">.</span>add_LibraryServices_to_server<span class="token punctuation">(</span>GrpcHandler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><p>And when you want to receive requests, start the server:</p><div class="remark-highlight"><pre class="language-python"><code class="language-python">server<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><button class="copy" data-v-fbb0a762><svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" data-v-fbb0a762><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" data-v-fbb0a762></path></svg></button></div><h3 id="prometheus"><a href="#prometheus" aria-hidden="true">#</a>Prometheus</h3><p><a href="https://github.com/prometheus" target="_blank" rel="nofollow noopener noreferrer">Prometheus</a> is an open-source systems monitoring and alerting toolkit. 
th2 use it to gather metrics from all the components for Grafana.</p><p><code>th2-common</code> automatically sends metrics based on:</p><ul><li>load on the system, created by your component;</li><li>load on your custom message queues;</li><li>load on message queues for th2 messages;</li><li>load on events message queues.</li></ul><p>It can be performed by the following utility methods in <code>CommonMetrics</code> class</p><ul><li><code>setLiveness</code> - sets &quot;liveness&quot; metric of a service (exported as <code>th2_liveness</code> gauge)</li><li><code>setReadiness</code> - sets &quot;readiness&quot; metric of a service (exported as <code>th2_readiness</code> gauge)</li><li>in order for the metrics to be exported, you will also need to create an instance of <code>CommonFactory</code></li><li>common JVM metrics will also be exported alongside common service metrics</li><li>some metric labels are enumerations (<code>th2_type</code>: <code>MESSAGE_GROUP</code>, <code>EVENT</code>, <code>&lt;customTag&gt;;message_type</code>: <code>RAW_MESSAGE</code>, <code>MESSAGE</code>)</li></ul><p>Prometheus collects metrics for Grafana. 
The following metrics are collected by <code>th2-common</code>.</p><p>ABSTRACT (RabbitMQ) METRICS:</p><p>Measures the amount of the data <strong>transferred via RabbitMQ</strong>. 
The data includes th2 batch messages, event or custom content.</p><ol><li>the total size of data published to RabbitMQ in bytes</li><li>the total size of data subscribed from RabbitMQ in bytes</li><li>The total number of data published to RabbitMQ (unit ???)</li><li>The time for data processing during subscription from RabbitMQ in seconds</li></ol><p>gRPC METRICS:</p><ol><li>total number calling a particular gRPC method</li><li>number of bytes sent to a particular gRPC call - request</li><li>number of bytes sent to a particular gRPC call - response</li></ol><p>MESSAGES METRICS:</p><ol><li>total quantity of all published messages (raw or parsed)</li><li>total quantity of all subscribed messages (raw or parsed)</li><li>total quantity of published messages dropped after filtering ( raw or parsed)</li><li>total quantity of subscribed messages dropped after filtering ( raw or parsed)</li><li>total quantity of published message groups</li><li>total quantity of subscribed message groups</li><li>total quantity of dropped published message groups after filtering</li><li>total quantity of dropped subscribed message groups after filtering</li><li>last published sequence</li><li>last subscribed sequence</li></ol><p>EVENT METRICS:</p><ol><li>total quantity of published events</li><li>total quantity of received events</li></ol></div><!----><!----></article></div><aside class="pl-5 pt-5 page-content-panel layout__aside--right" data-v-b7b561fc><nav class="pr-2 sticky-page-content" data-v-b7b561fc><div data-v-b7b561fc><div><a href="https://github.com/th2-net/th2-docs/blob/master/content/docs/fundamentals/th2-common/_index.md" target="_blank" class="v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-pencil-outline theme--light"></i></span></a><a href="https://github.com/th2-net/th2-docs/blob/master/content/docs/fundamentals/th2-common/_index.md" target="_blank">
       Edit this page
    </a></div></div><div data-v-b7b561fc><div><a href="https://github.com/th2-net/th2-docs/issues/new?title=One thing is unclear after reading &quot;th2-common&quot; article&amp;body=I've read [&quot;th2-common&quot; article](https://github.com/th2-net/th2-docs/blob/master/content/fundamentals/th2-common/_index.md) and there is one problem.&amp;assignees=d0rich&amp;labels=by-reader" target="_blank" class="v-btn v-btn--icon v-btn--round theme--light v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-alert-circle-outline theme--light"></i></span></a><a href="https://github.com/th2-net/th2-docs/issues/new?title=One thing is unclear after reading &quot;th2-common&quot; article&amp;body=I've read [&quot;th2-common&quot; article](https://github.com/th2-net/th2-docs/blob/master/content/fundamentals/th2-common/_index.md) and there is one problem.&amp;assignees=d0rich&amp;labels=by-reader" target="_blank">
       Create an issue
    </a></div></div><h3 class="mb-3 mt-7" data-v-b7b561fc>On this page</h3><ul data-v-b7b561fc><li class="font-weight-bold" data-v-b7b561fc><a href="#th2-common" data-v-b7b561fc><div data-v-b7b561fc>th2-common</div></a></li><li class="py-2" data-v-b7b561fc><a href="#commonfactory-class" data-v-b7b561fc><div data-v-b7b561fc>CommonFactory class</div></a></li><li class="py-2 h2-border" data-v-b7b561fc><a href="#setting-up-an-instance-of-common-factory" data-v-b7b561fc><div data-v-b7b561fc>Setting up an instance of Common Factory</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#option-1-user-creates-the-configuration-files-and-then-provides-the-path-to-these-files" data-v-b7b561fc><div data-v-b7b561fc>Option 1: User creates the configuration files and then provides the path to these files</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#option-2-access-config-files-from-the-kubernetes-cluster" data-v-b7b561fc><div data-v-b7b561fc>Option 2: Access config files from the Kubernetes cluster</div></a></li><li class="py-2 h2-border" data-v-b7b561fc><a href="#run-component" data-v-b7b561fc><div data-v-b7b561fc>Run component</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#option-1-run-without-arguments" data-v-b7b561fc><div data-v-b7b561fc>Option 1: Run without arguments</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#option-2-run-with-arguments" data-v-b7b561fc><div data-v-b7b561fc>Option 2: Run with arguments</div></a></li><li class="py-2 h2-border" data-v-b7b561fc><a href="#th2-common-integrations-configuration" data-v-b7b561fc><div data-v-b7b561fc>th2-common integrations configuration</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#rabbitmq" data-v-b7b561fc><div data-v-b7b561fc>RabbitMQ</div></a></li><li class="py-2 h2-border" data-v-b7b561fc><a href="#grpc" data-v-b7b561fc><div data-v-b7b561fc>gRPC</div></a></li><li class="ml-3 pb-2" data-v-b7b561fc><a href="#creating-client" data-v-b7b561fc><div data-v-b7b561fc>Creating client</div></a></li><li class="ml-3 pb-2" data-v-b7b561fc><a href="#creating-server" data-v-b7b561fc><div data-v-b7b561fc>Creating server</div></a></li><li class="ml-2 pb-2" data-v-b7b561fc><a href="#prometheus" data-v-b7b561fc><div data-v-b7b561fc>Prometheus</div></a></li></ul></nav></aside></div></div></div></main><footer class="v-footer flex justify-center py-6 v-sheet theme--dark secondary" data-v-28b3144a data-v-7b23e68f><div class="footer__content col" data-v-28b3144a><div class="d-flex justify-space-between footer__sections" data-v-28b3144a><div class="d-flex flex-column px-8 py-4 pa-sm-0 pa-xs-0" data-v-28b3144a><a href="https://exactpro.com/" class="mb-4" data-v-28b3144a><img src="/assets/img/logo_white.118f94fb.svg" style="width:max(200px, 100%);" data-v-28b3144a></a><div class="text-center" data-v-28b3144a>
          Build Software to Test Software
        </div></div><div class="d-flex flex-column px-8 py-4 pa-sm-0 pa-xs-0" data-v-28b3144a><h2 data-v-28b3144a>Contact Us</h2><div class="highliter my-3" data-v-28b3144a></div><div class="d-flex align-center contact" data-v-28b3144a><a href="mailto:docops@exactpro.com" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-28b3144a><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-email theme--dark" data-v-28b3144a></i></span></a><a href="mailto:docops@exactpro.com" class="contact__text" data-v-28b3144a>
            docops@exactpro.com
          </a></div><div class="d-flex align-center contact" data-v-28b3144a><a href="mailto:info@exactpro.com" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-28b3144a><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-email theme--dark" data-v-28b3144a></i></span></a><a href="mailto:info@exactpro.com" class="contact__text" data-v-28b3144a>
            info@exactpro.com
          </a></div><div class="d-flex align-center contact" data-v-28b3144a><a href="tel:+4402033191644" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-28b3144a><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-phone theme--dark" data-v-28b3144a></i></span></a><a href="tel:+4402033191644" class="contact__text" data-v-28b3144a>
            +44 (0) 20 3319 1644
          </a></div><div class="d-flex align-center contact" data-v-28b3144a><a href="tel:+16463403000" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-28b3144a><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-phone theme--dark" data-v-28b3144a></i></span></a><a href="tel:+16463403000" class="contact__text" data-v-28b3144a>
            +1 (646) 340 3000
          </a></div></div><div class="d-flex flex-column px-8 py-4 pa-sm-0 pa-xs-0" data-v-28b3144a><h2 data-v-28b3144a>Follow Us</h2><div class="highliter my-3" data-v-28b3144a></div><div class="d-flex" data-v-28b3144a><a href="https://github.com/th2-net" target="_blank" class="mr-2 v-btn v-btn--icon v-btn--round v-btn--tile theme--dark v-size--large" data-v-28b3144a><span class="v-btn__content"><div class="v-image v-responsive theme--dark" data-v-28b3144a><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a><a href="https://www.facebook.com/exactpro/" target="_blank" class="mr-2 v-btn v-btn--icon v-btn--round v-btn--tile theme--dark v-size--large" data-v-28b3144a><span class="v-btn__content"><div class="v-image v-responsive theme--dark" data-v-28b3144a><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a><a href="https://twitter.com/exactpro" target="_blank" class="mr-2 v-btn v-btn--icon v-btn--round v-btn--tile theme--dark v-size--large" data-v-28b3144a><span class="v-btn__content"><div class="v-image v-responsive theme--dark" data-v-28b3144a><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a><a href="https://www.linkedin.com/company/exactpro-systems-llc?trk=biz-companies-cym" target="_blank" class="mr-2 v-btn v-btn--icon v-btn--round v-btn--tile theme--dark v-size--large" data-v-28b3144a><span class="v-btn__content"><div class="v-image v-responsive theme--dark" data-v-28b3144a><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a><a href="https://www.youtube.com/c/exactprosystems" target="_blank" class="mr-2 v-btn v-btn--icon v-btn--round v-btn--tile theme--dark v-size--large" data-v-28b3144a><span class="v-btn__content"><div class="v-image v-responsive theme--dark" data-v-28b3144a><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:;background-position:center center;"></div><div class="v-responsive__content"></div></div></span></a></div></div></div><hr role="separator" aria-orientation="horizontal" class="my-12 v-divider theme--dark" data-v-28b3144a><div class="text-center text-caption" data-v-28b3144a>
      Copyright Â© 2009 - 2023 Exactpro. All Rights Reserved. Exactpro refers to Exactpro Systems Limited, registered in England and Wales, and/or one of its subsidiaries, each of which is a separate legal entity, registered in the relevant jurisdictions.
    </div><div class="text-center text-caption policies" data-v-28b3144a><a href="https://exactpro.com/terms-and-conditions" target="blank" class="mx-1" data-v-28b3144a>
         Terms and Conditions
      </a><a href="https://exactpro.com/privacy-policy" target="blank" class="mx-1" data-v-28b3144a>
         Privacy policy
      </a><a href="https://exactpro.com/cookies-policy" target="blank" class="mx-1" data-v-28b3144a>
         Cookies policy
      </a></div></div></footer></div></div></div>
    <script>window.__INITIAL_STATE__={"data":{"doc":{"title":"th2-common","inner_title":"","description":"","content":"\n# th2-common\n\n`th2-common` is a library used for enabling transfer of data in th2 and is required when setting up communications for a module.\n\nThe library is currently available in 3 languages: Java, Kotlin and Python. \nLinks to the open source repositories:\n\n1. Java & Kotlin - [GitHub - th2-net\u002Fth2-common-j](https:\u002F\u002Fgithub.com\u002Fth2-net\u002Fth2-common-j)\n2. Python - [GitHub - th2-net\u002Fth2-common-py](https:\u002F\u002Fgithub.com\u002Fth2-net\u002Fth2-common-py)\n\nTo be exact, these are some of the things the common library is used for:\n\n1. set up RabbitMQ consumer and producer \n2. set up gRPC client and server\n3. set up prometheus client\n\n   - collect metrics on loads to and from RabbitMQ,\n   - collect metrics about gRPC loads\n   - collect message metrics\n   - collect event metrics\n   - send metrics to Prometheus\n\nSome of the above activities are not automated and requires initial setting up by the user.\n\n## CommonFactory class\n\n`CommonFactory` is a class, that allows user to execute activities, related to communication between component developed and other th2 components.\n\nUsers should create instance of `CommonFactory`  in order to integrate a component into the th2 cluster. \n`CommonFactory` contains functions that will access configuration files to obtain the required settings which allows the module to make the connections with solutions such as RabbitMQ, gRPC or Prometheus.\n\nThere are two methods for accessing the configuration files.\n\n1. User creates the configuration files and then provides the path to these files\n2. Access config maps from the Kubernetes cluster\n\nThe configuration files (list below) required by a module to read:\n\n1. A **RabbitMQ** config from the `rabbitMQ.json` file\n2. A **message's router configuration** from the `mq.json` file\n3. A **gRPC router configuration** from the `grpc_router.json` file\n4. A **gRPC configuration** from the `grpc.json` file\n5. A **Cradle configuration** from the `cradle.json` file\n\n\u003Cnotice warning\u003E\n\nThese filenames can be customized, but it is recommended that file names remains unchanged. \n`CommonFactory` variant on Java has them hardcoded.\nIf files names were to be changed you should change them in the imported `CommonFactory` library for Java as well.\n\n\u003C\u002Fnotice\u003E\n\n## Setting up an instance of Common Factory\n\nTo gain access to the required configuration files, a user may choose to set up the instance named factory, of class `CommonFactory`, in the following ways. \nSeveral examples are provided below.\n\n### Option 1: User creates the configuration files and then provides the path to these files\n\nCreate instance of `CommonFactory` and provide access to the config files. \nThis should be specified during the start of the application.\n\n1. Create an instance with configs files in the default path (`\u002Fvar\u002Fth2\u002Fconfig\u002F*`)\n\n```java\n\nvar factory = new CommonFactory();\n\n```\n\n2. Provide custom paths as shown below\n\nThe `.json` config files should created and be placed in directories in the path.\n\n``` \n\nvar factory = new CommonFactory(rabbitMQ, routerMQ, routerGRPC, cradle, custom, prometheus, dictionariesDir);\n\n```\n\n3. Create instance with configs from command line arguments.  \nThe arguments from Group1 (see below) will access the user made config files. \n`args` is a string array of command line arguments.\n`.createFromArguments` returns a\n\n```java\n\nvar factory = CommonFactory.createFromArguments(args);\n\n```\n\n### Option 2: Access config files from the Kubernetes cluster\n\nEither use the `.createFromArguments()` method with arguments from group 2 or the `.createFromKubernetes()` method to access configuration files in the config maps of Kubernetes cluster\n```java\n\nvar factory = CommonFactory.createFromKubernetes(namespace, boxName, contextName, dictionaries);\n\n\n```\n\nTwo objects will be created:\n\n- `generated_configs` directory - this directory stores `.json` configuration files from Kubernetes;\n    - These files are overridden when `CommonFactory.createFromKubernetes(namespace, boxName)` and `CommonFactory.createFromKubernetes(namespace, boxName, contextName)` are invoked again.\n- `factory` - the tool object that contains interfaces which are used to set up connections with th2 services.\n\nThere are requirements that must be met when creating the object `factory` using Kubernetes:\n\n1. It is necessary to have Kubernetes configuration written in `~\u002F.kube\u002Fconfig`. See more on kubectl configuration [here](https:\u002F\u002Fkubernetes.io\u002Fdocs\u002Ftasks\u002Faccess-application-cluster\u002Fconfigure-access-multiple-clusters\u002F).\n2. User needs to have authentication with service account token that has the necessary access to read custom resources (CRs) and secrets from the specified namespace.\n   - Common Factory will look for RabbitMQ and Cassandra secret name and password key.\n\n\u003Cnotice note\u003E\n\nA custom resource (or CR) is an extension of the Kubernetes API, that represents a customization of a particular Kubernetes installation.\n\nA secret is an object that contains a small amount of sensitive data such as a password, a token, or a key. \nSecrets are similar to config maps but are specifically intended to hold confidential data.\n\n\u003C\u002Fnotice\u003E\n\n## Run component\n\nIn first attempts of running your component, you probably will run it as [external box](..\u002F..\u002Fcookbook\u002Frun-box-outside-cluster\u002F). \nDepending on the method used to create the component, you can run it in different ways.\n\n### Option 1: Run without arguments\n\nThe main commands to run the box are slightly different for different programming languages:\n\n- Java: `gradle run`\n- Python: `python run.py`\n\n### Option 2: Run with arguments\n\nIf you have not specified configs for `th2-common` to connect to the th2, you should specify them along with arguments in terminal. \nYou can use one of the groups of arguments provided below.\n\n\u003Cnotice note\u003E\n\nArguments from different groups cannot be used together.\n\n\u003C\u002Fnotice\u003E\n\nLocal files configuration arguments:\n\n- `--rabbitConfiguration` â€“ a path to the `.json` file with RabbitMQ configuration\n- `--messageRouterConfiguration` â€“ a path to the `.json` file with configuration for MessageRouter\n- `--grpcRouterConfiguration` â€“ a path to the `.json` file with configuration for gRPCRouter\n- `--cradleConfiguration` â€“ a path to the `.json` file with configuration for Cradle\n- `--customConfiguration` â€“ a path to the `.json` file with a custom configuration\n- `--dictionariesDir` â€“ a path to the directory with encoded dictionary files\n- `--prometheusConfiguration` â€“ a path to the `.json` file with a configuration for Prometheus metrics server\n- `--boxConfiguration` â€“ a path to the `.json` file with external box\n- `-c\u002F` and `--configs` â€“ a folder with `.json` files for schema configurations with following names:\n\n1) rabbitMq.json â€“ a configuration file for RabbitMQ\n\n2) mq.json â€“ a configuration file for MessageRouter\n\n3) grpc.json â€“ a configuration file for gRPCRouter\n\n4) cradle.json â€“ a configuration file for the Cradle API\n\n5) custom.json â€“ custom configuration\n\nKubernetes-based configuration arguments:\n\n\u003Cnotice note\u003E\n\nwhen using these arguments, prior installation and configuration of kubectl is required\n\n\u003C\u002Fnotice\u003E\n\n- `--namespace` â€“ the namespace in Kubernetes to search for config maps\n\n- `--boxName` â€“ the name of the target th2 box placed in the specified Kubernetes namespace\n\n- `--contextName` â€“ the context name to search connection parameters in kubeconfig\n\n- `--dictionaries` â€“ the mapping between a dictionary in infra-schema and a dictionary type specified in the following format: `--dictionaries \u003Cdictionary name\u003E=\u003Cdictionary type\u003E [\u003Cdictionary name\u003E=\u003Cdictionary type\u003E]`.\n  This argument is provided  when dictionaries are required to start a specific box.\n\n\n\nA CLI command example:\n\n```java\n\ngradle run --args='--namespace myNamespace --boxName myExternalBox --contextName myContext'\n\n```\n\nWith these parameters, your component will connect to the destination Kubernetes cluster and namespace, and find the right entry point (that is external box itself) to act from.\n\nAlso, there are special ConfigMaps in the *schema* namespace with the parameters for connecting to the th2 infrastructure. \n`th2-common` will save it automatically in the repository of the box you are running.\n\n## th2-common integrations configuration\n\nth2 as a framework based on open-source technologies, made by other developers.\nThey allows data storage, interchange and displaying.\n\n### RabbitMQ\n\nRabbitMQ is a powerful engine for message queues. \nIt allows you to be confident that some component of the system will receive a message in any case.\n\nAfter RabbitMQ is installed in your th2 cluster, this service is accessible within Kubernetes private network and for external systems. \nConfiguration for connecting to the RabbitMQ service can be applied automatically or set manually. \nIt depends on how you created the instance of `CommonFactory`.\n\nAfter you created `factory` object, you can get routers for receiving and sending messages.\n\n\u003Cnotice note\u003E\n\nCode examples here are given in Java. \nAnd it can be different for other programming languages.\n\n\u003C\u002Fnotice\u003E\n\n```java\n\nvar messageRouter = factory.getMessageRouterParsedBatch();\nvar rawRouter = factory.getMessageRouterRawBatch();\nvar eventRouter = factory.getEventBatchRouter();\n\n```\n\nThis example creates 3 different routers for 3 batches:\n\n- `messageRouter` is working with `MessageBatch`;\n- `rawRouter` is working with `RawMessageBatch`;\n- `eventRouter` is working with `EventBatch`.\n\nThese batches differ from each other by content type.\n\nWith the router created, you can subscribe to pins (by specifying the callback function) or to send data that the router works with:\n\n```java\n\nrouter.subscribe(callback, attrs...);  \u002F\u002F subscribe to only one pin\nrouter.subscribeAll(callback, attrs...);  \u002F\u002F subscribe to one or several pins\nrouter.send(message, attrs...);  \u002F\u002F send to only one pin\nrouter.sendAll(message, attrs...);  \u002F\u002F send to one or several pins\n\n```\n\n`attrs...` is non-mandatory list of pin attributes to filter pins for action. \nIf these attributes are not specified pins will be filtered by default attributes. \nDefault attributes depend on the router and action types:\n\n- `message_parsed_batch_router`\n  - Subscribe: `subscribe`, `parsed`\n  - Send: `publish`, `parsed`\n- `message_raw_batch_router`\n  - Subscribe: `subscribe`, `raw`\n  - Send: `publish`, `raw`\n- `event_batch_router`\n  - Subscribe: `subscribe`, `event`\n  - Send: `publish`, `event`\n\nIf you want to use default pins for router, specify `callback` or `message` only as first parameter:\n\n```java\n\nrouter.subscribe(callback);\nrouter.subscribeAll(callback);\nrouter.send(message);\nrouter.sendAll(message);\n\n```\n\nIf you want to provide some custom attributes, you will need to list them as strings after the first parameter:\n\n```java\n\nrouter.subscribe(callback, \"subscribe\", \"parsed\");\nrouter.subscribeAll(callback, \"subscribe\", \"event\");\nrouter.send(message, \"publish\", \"raw\");\nrouter.sendAll(message, \"publish\", \"raw\");\n\n```\n\nPlease be careful that all messages are filtered on the level of `th2-common`. \nSo Kubernetes do not affect on the message delivery. \nAnd RabbitMQ only provides channels for messages.\n\nThere is a list of predefined Pinâ€™s attributes for th2 framework. \nAnd it will be better for you, if you follow architecture recommendations by the th2 team.\n\nLet you know, that this Pinâ€™s attributes system is very flexible and you can define any attributes you want. \nBut keep in mind, that these attributes must be specified in `subscribe()` and `send()` methods calls.\n\nFor example, you can see how two th2 modules send messages to each other. \nKeep in mind, that every Pin is connected to only 1 Pin in another module.\n\n![RabbitMQ workflow](.\u002Frabbitmq_workflow.png)\n\nSent message has the following lifecycle:\n\n1. `th2-module-1` calls a method for sending message;\n2. `th2-common` in `th2-module-1` choose Pins to send message with. \nPins are filtered by attributes given in `send` method call;\n3. message is sent with RabbitMQ client in `th2-common` in `th2-module-1`;\n4. message on RabbitMQ server is redirected to right endpoint (Pin on the `th2-module-2`)\n5. message is received by RabbitMQ client in `th2-common` in `th2-module-2`;\n6. message is filtered by its content with Pinâ€™s filters;\n7. `th2-common` choose callback to trigger by attributes of Pin-receiver provided in the method call for subscription.\n\n## gRPC\n\ngRPC is a high performance protocol for messaging between apps. \nAnd you can use it for integration of your th2 module to the system.\n\nTo use gRPC protocol it is needed to create gRPC client (for sending messages) and gRPC server (to receive messages) in your app. \nBasically, `th2-common` will do it for you.\n\nIf you use gRPC it is required to define an endpoint in extended settings for it in the `Th2Box` configuration:\n\n```yaml\n\nextended-settings:\n  service:\n    enabled: true\n    type: NodePort\n    endpoints:\n      - name: grpc\n        targetPort: 8080\n        nodePort: 31179\n\n```\n\nEndpoint parameters:\n\n- `name` must be `grpc`\n- `targetPort` - port on the Pod which gRPC server and client are listening\n- `nodePort` - port on the global th2 service (provided by NGINX Ingress Controller). \nRequests to this port are redirected to the Podâ€™s `targetPort`\n\n\u003Cnotice note\u003E\n\nCode examples here are given in Python . And it can be different for other programming languages.\n\n\u003C\u002Fnotice\u003E\n\nFirst of all we need to get `grpc_router` from `CommonFactory` instance, like with routers for RabbitMQ.\n\n```python\n\ngrpc_router = factory.grpc_router\n\n```\n\n#### Creating client\n\ngRPC client sends requests to other modules. gRPC is a typed protocol. \nIt means that you are not allowed to send any message you want. \nThe message must have specific structure described in `.proto` files (e.g. https:\u002F\u002Fgithub.com\u002Fth2-net\u002Fth2-grpc-common\u002Fblob\u002Fmaster\u002Fsrc\u002Fmain\u002Fproto\u002Fth2_grpc_common\u002Fcommon.proto ) and then transferred to the native programming language classes.\n\nMost of th2 modules which uses gRPC have additional `th2-grpc-...` repository with described messages structure and prepared to generate Python or Java classes.\n\nGenerate special gRPC services class for component, you want to integrate with your module. And then provide it in your module.\n\n```python\n\nservice = router.get_service(Service)\n\n```\n\nAnd thatâ€™s all, now you can send messages to another component with gRPC. \nJust call needed method in service by name.\n\n```python\n\nservice.needed_method_name(request, timeout)\n\n```\n\nWhere parameters are:\n\n- `request` is the data that we send \n- `timeout` is the timeout for the request\n\n#### Creating server\n\nFirst of all we need to define gRPC messages structure via `.proto` files and transform it to the native class, like as described for gRPC client. \nFor the new module we can use https:\u002F\u002Fgithub.com\u002Fth2-net\u002Fth2-grpc-common  as the template and change it for our needs.\n\n\u003Cnotice note\u003E\n\nIf you implement some existing module, you can use appropriate `th2-grpc-...` repository.\n\n\u003C\u002Fnotice\u003E\n\nAfter that generate service class and import it to the module. \nUse this class (`LibraryServicer` in example) to create your custom one (`GrpcHandler` in example) with overrided methods:\n\n```python\n\nclass GrpcHandler(LibraryServicer):\n\n    def method_1(self, request, context):\n        ...\n\n    ...\n\n    def method_n(self, request, context):\n        ...\n\n```\n\nCreate gRPC server with `router`:\n\n```python\n\nserver = router.server\n\n```\n\nCreate an instance of your custom gRPC handler and add services from it the local gRPC server with `add_LibraryServices_to_server()` method.\n\n```python\n\nfrom th2_grpc_library import library_pb2_grpc\n\nlibrary_pb2_grpc.add_LibraryServices_to_server(GrpcHandler(), server)\n\n```\n\nAnd when you want to receive requests, start the server:\n\n```python\n\nserver.start()\n\n```\n\n### Prometheus\n\n[Prometheus](https:\u002F\u002Fgithub.com\u002Fprometheus) is an open-source systems monitoring and alerting toolkit. \nth2 use it to gather metrics from all the components for Grafana.\n\n`th2-common` automatically sends metrics based on:\n\n- load on the system, created by your component;\n- load on your custom message queues;\n- load on message queues for th2 messages;\n- load on events message queues.\n\nIt can be performed by the following utility methods in `CommonMetrics` class\n\n- `setLiveness` - sets \"liveness\" metric of a service (exported as `th2_liveness` gauge)\n- `setReadiness` - sets \"readiness\" metric of a service (exported as `th2_readiness` gauge)\n- in order for the metrics to be exported, you will also need to create an instance of `CommonFactory`\n- common JVM metrics will also be exported alongside common service metrics\n- some metric labels are enumerations (`th2_type`: `MESSAGE_GROUP`, `EVENT`, `\u003CcustomTag\u003E;message_type`: `RAW_MESSAGE`, `MESSAGE`)\n\nPrometheus collects metrics for Grafana. \nThe following metrics are collected by `th2-common`.\n\nABSTRACT (RabbitMQ) METRICS:\n\nMeasures the amount of the data **transferred via RabbitMQ**. \nThe data includes th2 batch messages, event or custom content.\n\n1. the total size of data published to RabbitMQ in bytes\n2. the total size of data subscribed from RabbitMQ in bytes\n3. The total number of data published to RabbitMQ (unit ???)\n4. The time for data processing during subscription from RabbitMQ in seconds\n\ngRPC METRICS:\n\n1. total number calling a particular gRPC method\n2. number of bytes sent to a particular gRPC call - request\n3. number of bytes sent to a particular gRPC call - response\n\nMESSAGES METRICS:\n\n1. total quantity of all published messages (raw or parsed)\n2. total quantity of all subscribed messages (raw or parsed)\n3. total quantity of published messages dropped after filtering ( raw or parsed)\n4. total quantity of subscribed messages dropped after filtering ( raw or parsed)\n5. total quantity of published message groups\n6. total quantity of subscribed message groups\n7. total quantity of dropped published message groups after filtering\n8. total quantity of dropped subscribed message groups after filtering\n9. last published sequence\n10. last subscribed sequence\n\nEVENT METRICS:\n\n1. total quantity of published events\n2. total quantity of received events","fileInfo":{"path":"fundamentals\u002Fth2-common\u002F_index.md"},"headings":[{"anchor":"#th2-common","value":"th2-common","depth":1},{"anchor":"#commonfactory-class","value":"CommonFactory class","depth":2},{"anchor":"#setting-up-an-instance-of-common-factory","value":"Setting up an instance of Common Factory","depth":2},{"anchor":"#option-1-user-creates-the-configuration-files-and-then-provides-the-path-to-these-files","value":"Option 1: User creates the configuration files and then provides the path to these files","depth":3},{"anchor":"#option-2-access-config-files-from-the-kubernetes-cluster","value":"Option 2: Access config files from the Kubernetes cluster","depth":3},{"anchor":"#run-component","value":"Run component","depth":2},{"anchor":"#option-1-run-without-arguments","value":"Option 1: Run without arguments","depth":3},{"anchor":"#option-2-run-with-arguments","value":"Option 2: Run with arguments","depth":3},{"anchor":"#th2-common-integrations-configuration","value":"th2-common integrations configuration","depth":2},{"anchor":"#rabbitmq","value":"RabbitMQ","depth":3},{"anchor":"#grpc","value":"gRPC","depth":2},{"anchor":"#creating-client","value":"Creating client","depth":4},{"anchor":"#creating-server","value":"Creating server","depth":4},{"anchor":"#prometheus","value":"Prometheus","depth":3}],"read_before":[],"continue_learning":[],"terms":[],"related":[],"hide_releases":null,"_githubRepository":null},"readmeDoc":null},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.b145ed99.js" defer></script><script src="/assets/js/page--src--templates--documentation-vue.8ae7a293.js" defer></script><script src="/assets/js/vue-remark--content--docs--fundamentals--th-2-common--index-md.5bd95f70.js" defer></script>
  </body>
</html>
