{"hash":"52cfc19837ae1878d85a067c007f00eee91f7836","data":{"doc":{"title":"Verification by a single rule request","inner_title":"","description":"","content":"\n# Verification by a single rule request\n\n##  Verification using `CheckSequenceRuleRequest`\n\n![Figure 1. Verification of message queue by **check1** using `CheckSequenceRuleRequest`](./img/verification_flowchart.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure1. Verification of message queue by **check1** using `CheckSequenceRuleRequest`.\n</figcaption>\n</center>\n\n\n## Structure of the `CheckSequenceRuleRequest`\n\n![Figure 2. Class Diagram of CheckSequenceRuleRequest](./img/checksequence_class.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 2. Class Diagram of `CheckSequenceRuleRequest`\n</figcaption>\n</center>\n\n`CheckSequenceRuleRequest` is the recommended rule request since it comes with additional capabilities that overlap the functional capabilities of the other two rule requests.\n\n### The PreFilter Class\n`CheckSequenceRuleRequest` comes with a pre-filter. \nA pre-filter is a mechanism for filtering messages that are not of interest to the user, for example - Heartbeats in FIX. \nThe pre-filter allows checking of only those messages that have passed through it. \nTherefore, users must be careful to not accidentally filter out potentially necessary messages.\n\n![Figure 3. Messages (in black) are not considered for verification due to PreFilter](./img/prefilter.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 3. Messages (in black) are not considered for verification due to PreFilter. \n</figcaption>\n</center>\n\n### Identifying system responses\nAfter pre-filtering, the messages in the queue have to be matched with the main filters (class `RootMessageFilters[]` ) to identify the expected messages. \nThe expected responses are identified via the key fields found in the main filter. \n`key_fields` is a list of fields that will be used as keys when determining whether the expected message has been received or not.\n\nEach filter contains a key field which matches with a single expected message. `CLOrdid` (client order id) is used as the key field and **check1** matches the filter-message pair according to the value.\n\n![Figure 4. The three filters matching up with three responses(turquois color)](./img/mainfilter.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 4. The three filters matching up with three responses (turquois color)\n</figcaption>\n</center>\n\n### Locating unexpected messages\nIf a message passed pre-filter, but is not in the expected, it is considered as an extra message. \nThe extra messages are located by setting the `silence_check` parameter to `True` or by the `auto-silence-check-after-sequence-rule` in the **check1** custom configuration.\n\n![Figure 5. An extra message is identified by silence check](./img/silencecheck.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 5. An extra message is identified by silence check\n</figcaption>\n</center>\n\n### Completion of Verification\nYou can allocate the amount of time for rule execution using the rule parameter timeout .\n\nIf timeout is not specified in the rule request, the default value is **check1**â€™s rule-execution-timeout property.\n\nThe rule execution stops automatically after the allocated time passes. \nThe time unit is measured milliseconds.\n\n### Unmatched Filters\nIf any or none of the filters match up with the message(s) in the queue within the allocated time the user is notified about the mismatch between the number of received and expected system messages.\n\n### Verification of message order\nThe filters in `CheckSequenceRuleRequest` are an ordered list and the order received should match with the filter order.\n\nTo check order, the `CheckSequenceRuleRequest` parameter `check_order` is set to `True`.\n\n![Figure 6. Filter order (expected order) does not match the message order received (actual)](./img/checkorder.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 6. Filter order (expected order) does not match the message order received (actual).\n</figcaption>\n</center>\n\n### Field validation\nOnce the expected messages are located, field validation is conducted by comparing the expected values to the actual values of the parameters. \nThe user is notified of any inaccuracies.\n\n### Returning a Chain ID\nOnce verification is complete **check1** returns a chain id value which can be used for chain verification\n\n## Using CheckRuleRequest for  verification\n\n![Figure 7. Structure of the CheckRuleRequest](./img/checkrule_class.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 7. Structure of the CheckRuleRequest.\n</figcaption>\n</center>\n\nThe `CheckRuleRequest` function is similar to the `CheckSequenceRuleRequest` but is used to locate a single message in the message queue. \nSince the `CheckRuleResponse` returns a value for chain_id you could use this rule to continue verification. \n\n### Using NoMessageRuleRequest\nThis rule request is used to check for extra messages, and comes with a PreFilter class. \n\n![Figure 8. Structure of NoMessageCheckRequest](./img/Nomessage_class.png)\n\n<center> \n<figcaption class=\"mb-2\">\nFigure 8. Structure of NoMessageCheckRequest.\n</figcaption>\n</center>\n\n","fileInfo":{"path":"modules/check1/verification_rulerequests.md"},"headings":[{"anchor":"#verification-by-a-single-rule-request","value":"Verification by a single rule request","depth":1},{"anchor":"#verification-using-checksequencerulerequest","value":"Verification using CheckSequenceRuleRequest","depth":2},{"anchor":"#structure-of-the-checksequencerulerequest","value":"Structure of the CheckSequenceRuleRequest","depth":2},{"anchor":"#the-prefilter-class","value":"The PreFilter Class","depth":3},{"anchor":"#identifying-system-responses","value":"Identifying system responses","depth":3},{"anchor":"#locating-unexpected-messages","value":"Locating unexpected messages","depth":3},{"anchor":"#completion-of-verification","value":"Completion of Verification","depth":3},{"anchor":"#unmatched-filters","value":"Unmatched Filters","depth":3},{"anchor":"#verification-of-message-order","value":"Verification of message order","depth":3},{"anchor":"#field-validation","value":"Field validation","depth":3},{"anchor":"#returning-a-chain-id","value":"Returning a Chain ID","depth":3},{"anchor":"#using-checkrulerequest-for--verification","value":"Using CheckRuleRequest for  verification","depth":2},{"anchor":"#using-nomessagerulerequest","value":"Using NoMessageRuleRequest","depth":3}],"read_before":[],"continue_learning":[],"terms":[],"related":[{"name":"th2-net/th2-check1","icon":"mdi-github","href":"https://github.com/th2-net/th2-check1"}],"hide_releases":null,"_githubRepository":null},"readmeDoc":null},"context":{}}