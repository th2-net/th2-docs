{"hash":"2c39d0f6c4e74e25e9cd96bd966a35a86b99cf6b","data":{"doc":{"__typename":"ModulePage","title":"Overview","description":"","content":"\n# Overview\n\n**mstore** (th2 message store) is an important th2 component responsible for storing raw messages into <term term=\"Cradle\">Cradle</term>. \nThis component has a pin for listening to messages via MQ.\n\nAs a part of th2-core, **mstore** is responsible for saving and displaying data. \nThis component's logic is same for all the th2 environments. \nMessages are the data that is going in or out of th2. **mstore** saves content and metadata of those messages. \n\nWhen marking the pins during configurating other components, you can specify `store` attribute, which means that the messages from this pin will be stored via **mstore.** \n\n**mstore** interacts with Cradle and <term term=\"th2-common\">Common libraries</term>. \nUsing RabbitMQ **mstore** gets messages in batches, then it will try to pack batches more compactly, and finally write them to Cassandra using Cradle library. \nTake into account that the batches cannot be merged, if combined batch exceeds the size limitation configured in Cradle.\n\n## Functionality\n\nTo automatically connect the pin to **mstore** and to collect all the messages into <term term=\"Cradle\">Cradle</term>, you must mark a pin that produces raw messages in **conn**, **read** and **hand** boxes via the `store` attribute. \n\n**mstore** consumes raw messages. \nParsed messages are not accepted. \n\nRaw message is a base entity of th2. \nAll incoming / outgoing data is stored in this format. \nEvery raw message contains the following important parts:â€‹\n\n- session alias - unique identifier of business session;\n\n- direction - <term term=\"direction\">direction</term> of message stream;\n\n- sequence number - incremental identifier;\n\n- data - byte representation of a raw message.\n\nSession alias, direction and sequence number are a compound unique identifier of raw messages within th2.\n\n**mstore** uses two libraries - <term term=\"th2-common\">common</term> and Cradle.\n\nCommon library is responsible for collecting messages in **mstore** from all pins with `store` attribute.\n\n**mstore** uses Cradle library to write message batches in Cassandra.\n\n","fileInfo":{"path":"mstore/overview.md"},"headings":[{"anchor":"#overview","value":"Overview","depth":1},{"anchor":"#functionality","value":"Functionality","depth":2}],"terms":[{"id":"Cradle","title":"Cradle","content":"<p>Cradle is a datalake where th2 stores messages and events. It is based on Cassandra database and creates th2-specific data processing.</p>\n"},{"id":"th2-common","title":"th2-common","content":"<p>Basic library for th2 components. It provides API for interaction with other components, access to the <strong>th2-box</strong> configuration, and some functionality for automatic consuming of statistics. </p>\n"},{"id":"direction","title":"direction","content":"<p>Direction is th2 specific enumeration for designating direction of the message in the system:</p>\n<ul>\n<li><code>first</code> - messages are sent to System Under Test (request);</li>\n<li><code>second</code> - messages are recieved from System Under Test (response)</li>\n</ul>\n"}],"meta":{"contentTreeJSON":"[{\"title\":\"mstore\",\"path\":\"/modules/mstore/\",\"weight\":-100,\"followPath\":\"/modules/mstore/overview/\",\"children\":[{\"title\":\"Overview\",\"path\":\"/modules/mstore/overview/\",\"weight\":0,\"followPath\":\"/modules/mstore/overview/\",\"children\":[]},{\"title\":\"Repositories\",\"path\":\"/modules/mstore/repositories/\",\"weight\":5,\"followPath\":\"/modules/mstore/repositories/\",\"children\":[]},{\"title\":\"Configuration\",\"path\":\"/modules/mstore/config/\",\"weight\":10,\"followPath\":\"/modules/mstore/config/\",\"children\":[]},{\"title\":\"Useful hints\",\"path\":\"/modules/mstore/usage/\",\"weight\":15,\"followPath\":\"/modules/mstore/usage/\",\"children\":[]}]}]","module_name":"mstore","main_path":"/modules/mstore/"}}},"context":{}}